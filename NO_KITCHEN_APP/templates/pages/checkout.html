<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Checkout - Razorpay</title>
  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f4f8ff;
      padding: 40px;
    }

    .checkout-container {
      max-width: 500px;
      margin: auto;
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 4px 16px rgba(0,0,0,0.1);
    }

    .checkout-container h2 {
      margin-bottom: 20px;
      color: #333;
    }

    .price-info {
      font-size: 18px;
      margin: 10px 0;
      color: #444;
    }

    .pay-btn {
      background: #0b7dda;
      color: white;
      padding: 12px 20px;
      font-size: 16px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 25px;
      width: 100%;
    }

    .pay-btn:hover {
      background: #095bb5;
    }
  </style>
</head>
<body>
  <div class="checkout-container">
    <h2>Confirm & Pay</h2>

    <div class="price-info">Menu Plan Price: ₹{{ menuplan_price }}</div>
    <div class="price-info">Custom Selection Price: ₹{{ selection_price }}</div>
    <hr>
    <div class="price-info"><strong>Total Amount: ₹{{ total_price }}</strong></div>

    <button id="payBtn" class="pay-btn">Pay Now</button>
  </div>

  <script>
    const options = {
      key: "{{ razorpay_key_id }}",  // from backend
      amount: "{{ total_price|floatformat:2|floatformat:'0' }}00",  // Convert ₹ to paise
      currency: "INR",
      name: "Weekly Meal Service",
      description: "Meal Plan Payment",
      image: "https://yourlogo.url/logo.png",
      handler: function (response) {
        // Redirect or call your payment success view
        window.location.href = `/payment_success/?payment_id=${response.razorpay_payment_id}`;
      },
      prefill: {
        name: "{{ user.first_name }}",
        email: "{{ user.email }}"
      },
      theme: {
        color: "#0b7dda"
      }
    };

    const rzp = new Razorpay(options);
    document.getElementById("payBtn").onclick = function (e) {
      rzp.open();
      e.preventDefault();
    };
  </script>
</body>
</html>
